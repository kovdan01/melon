name: Build Windows

on:
  push:
    branches: develop
  pull_request:
    branches: develop

jobs:
  build-core-server-client-desktop:
    name: ${{ format('Windows {0} {1}', matrix.config.build_type, matrix.config.suffix) }}
    runs-on: ${{ matrix.config.os }}
    env:
      CMAKE_TOOL_VERSION: "3.19.1"
      CMAKE_TOOL_PATH: "cmake-tool"
      NINJA_TOOL_VERSION: "1.10.2"
      NINJA_TOOL_PATH: "ninja-tool"
      BOOST_MAJOR: 1
      BOOST_MINOR: 76
      BOOST_BUILD: 0
      BOOST_INSTALL_PATH: "boost-install"
      SQLPP11_VERSION: "0.60"
      SQLPP11_CONNECTOR_MYSQL_VERSION: "0.29"
      CHRONO_DATE_VERSION: "3.0.0"
      SQLPP11_INSTALL_PATH: "sqlpp11-install"
      CATCH2_VERSION: "2.13.4"
      CATCH2_INSTALL_PATH: "catch2-install"
      MSYS_CACHE_VERSION: 17  # increment when need to update msys packages
    strategy:
      fail-fast: true
      matrix:
        config:
        - {
            os: "windows-latest",
            prefix: "Windows",
            suffix: "",
            msys_variant: "ucrt64",
            package_prefix: "mingw-w64-ucrt-x86_64-",
            artifact: "all-release-windows",
            build_type: "Release",
            cc: "gcc",
            cxx: "g++",
          }
        - {
            os: "windows-latest",
            prefix: "Windows",
            suffix: "",
            msys_variant: "mingw64",
            package_prefix: "mingw-w64-x86_64-",
            artifact: "all-release-windows",
            build_type: "Release",
            cc: "gcc",
            cxx: "g++",
          }

    steps:
    - uses: actions/checkout@v2

    - name: Set environment variables
      shell: python {0}
      run: |
        import os

        repo = os.path.normpath(os.environ['GITHUB_WORKSPACE'])
        root = os.path.normpath(os.path.dirname(repo))

        cmake_tool_path = os.environ['CMAKE_TOOL_PATH']

        with open(os.environ['GITHUB_ENV'], 'a') as env_file:
          env_file.write("REPO_PATH={}\n".format(repo.replace("\\", "/")))
          env_file.write("ROOT_PATH={}\n".format(root.replace("\\", "/")))
          env_file.write("CMAKE_TOOL_BINARY_PATH={}\n".format(os.path.join(root, cmake_tool_path, "bin").replace("\\", "/")))

    - name: Install required python modules
      run: |
        pip install requests

    - name: Install MSYS packages
      shell: C:\\msys64\\msys2_shell.cmd -defterm -no-start -${{ matrix.config.msys_variant }} -shell sh {0}
      run: |
        pacman -Syu
        pacman -S --noconfirm ${{ matrix.config.package_prefix }}python-pip
        pip install pyparsing
        pacman -S --noconfirm ${{ matrix.config.package_prefix }}gcc
        pacman -S --noconfirm ${{ matrix.config.package_prefix }}pkg-config
        pacman -S --noconfirm ${{ matrix.config.package_prefix }}brotli

    - name: Ninja and CMake cache
      uses: actions/cache@v2
      id: cache_ninja_and_cmake
      with:
        path: |
          ${{ env.ROOT_PATH }}/${{ env.CMAKE_TOOL_PATH }}
          ${{ env.ROOT_PATH }}/${{ env.NINJA_TOOL_PATH }}
          C:/msys64/${{ matrix.config.msys_variant }}/bin/ninja.exe
        key: ${{ runner.os }}-ninja-${{ env.NINJA_TOOL_VERSION }}-cmake-${{ env.CMAKE_TOOL_VERSION }}-1

    - name: Download Ninja and CMake
      id: download_ninja_and_cmake
      if: ${{ steps.cache_ninja_and_cmake.outputs.cache-hit != 'true' }}
      shell: python {0}
      run: |
        import os
        import requests
        import shutil
        import subprocess

        def execute_command(cmd):
          ret = subprocess.call(cmd, shell=True)
          if ret != 0:
            raise RuntimeError('Exit code {} while executing "{}"'.format(ret, cmd))

        root = os.environ['ROOT_PATH']
        repo = os.environ['REPO_PATH']

        os.chdir(root)

        cmake_version = os.environ['CMAKE_TOOL_VERSION']
        ninja_version = os.environ['NINJA_TOOL_VERSION']
        cmake_tool_path = os.environ['CMAKE_TOOL_PATH']
        ninja_tool_path = os.environ['NINJA_TOOL_PATH']
        cmake_tool_binary_path = os.environ['CMAKE_TOOL_BINARY_PATH']

        ninja_suffix = "win.zip"
        cmake_suffix = "win64-x64.zip"
        cmake_dir = "cmake-{}-win64-x64".format(cmake_version)

        os.mkdir(ninja_tool_path)
        os.chdir(ninja_tool_path)
        ninja_url = "https://github.com/ninja-build/ninja/releases/download/v{}/ninja-{}".format(ninja_version, ninja_suffix)
        open("ninja.zip", "wb").write(requests.get(ninja_url, allow_redirects=True).content)
        execute_command("7z x ninja.zip")
        shutil.copy('ninja.exe', 'C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\ninja.exe')
        os.chdir(root)

        cmake_url = "https://github.com/Kitware/CMake/releases/download/v{}/cmake-{}-{}".format(cmake_version, cmake_version, cmake_suffix)

        open("cmake.zip", "wb").write(requests.get(cmake_url, allow_redirects=True).content)
        execute_command("7z x cmake.zip")
        os.rename(cmake_dir, cmake_tool_path)

        os.chdir(repo)

    - name: Boost cache
      uses: actions/cache@v2
      id: cache_boost
      with:
        path: ${{ env.ROOT_PATH }}/${{ env.BOOST_INSTALL_PATH }}
        key: ${{ runner.os }}-boost-${{ env.BOOST_MAJOR }}-${{ env.BOOST_MINOR }}-${{ env.BOOST_BUILD }}-all-4

    - name: Boost
      id: boost
      if: ${{ steps.cache_boost.outputs.cache-hit != 'true' }}
      env:
        CC: ${{ matrix.config.cc }}
        CXX: ${{ matrix.config.cxx }}
      shell: python {0}
      run: |
        import os
        import requests
        import subprocess

        def execute_command(cmd):
          ret = subprocess.call(cmd, shell=True)
          if ret != 0:
            raise RuntimeError('Exit code {} while executing "{}"'.format(ret, cmd))

        root = os.environ['ROOT_PATH']
        repo = os.environ['REPO_PATH']

        os.chdir(root)

        boost_major = os.environ['BOOST_MAJOR']
        boost_minor = os.environ['BOOST_MINOR']
        boost_build = os.environ['BOOST_BUILD']

        boost_source_dir  = os.path.normpath(os.path.join(root, "boost_{}_{}_{}".format(boost_major, boost_minor, boost_build)))
        boost_install_dir = os.path.normpath(os.path.join(root, "${{ env.BOOST_INSTALL_PATH }}")).replace("\\", "/")
        os.mkdir(boost_install_dir)

        boost_url = "https://boostorg.jfrog.io/artifactory/main/release/{}.{}.{}/source/boost_{}_{}_{}.zip".format(boost_major, boost_minor, boost_build,
                                                                                                                   boost_major, boost_minor, boost_build)
        open("boost.zip", "wb").write(requests.get(boost_url, allow_redirects=True).content)
        execute_command("7z x boost.zip")

        os.chdir(boost_source_dir)

        cmd_prefix = "C:\\msys64\\msys2_shell.cmd -defterm -no-start -here -${{ matrix.config.msys_variant }} -shell sh -c "

        execute_command(cmd_prefix + '"chmod +x ./bootstrap.sh"')
        execute_command(cmd_prefix + '"chmod +x ./tools/build/src/engine/build.sh"')

        toolset = "${{ env.CC }}"
        execute_command(cmd_prefix + '"./bootstrap.sh --with-toolset={} --without-libraries=python --prefix={}"'.format(toolset, boost_install_dir))
        execute_command(cmd_prefix + '"./b2"')
        execute_command(cmd_prefix + '"./b2 install"')

        os.chdir(repo)

    - name: Utils by Pavel A. Lebedev
      env:
        CC: ${{ matrix.config.cc }}
        CXX: ${{ matrix.config.cxx }}
      shell: C:\\msys64\\msys2_shell.cmd -defterm -no-start -${{ matrix.config.msys_variant }} -shell sh {0}
      run: |
        # ntc-cmake
        cd ${{ env.REPO_PATH }}/cmake/ntc
        mkdir prefix

        ${{ env.CMAKE_TOOL_BINARY_PATH }}\\cmake \
            -G Ninja \
            -S . \
            -B build \
            -D CMAKE_INSTALL_PREFIX="${{ env.REPO_PATH }}/cmake/ntc/prefix" \
            -D CMAKE_RANLIB=/${{ matrix.config.msys_variant }}/bin/ranlib.exe \
            -D CMAKE_VERBOSE_MAKEFILE=ON \
            -D CMAKE_MAKE_PROGRAM=/${{ matrix.config.msys_variant }}/bin/ninja.exe \
            -D CMAKE_C_COMPILER=/${{ matrix.config.msys_variant }}/bin/gcc.exe \
            -D CMAKE_CXX_COMPILER=/${{ matrix.config.msys_variant }}/bin/g++.exe \
            -D CMAKE_AR=/${{ matrix.config.msys_variant }}/bin/ar.exe \
            -D CMAKE_LINKER=/${{ matrix.config.msys_variant }}/bin/ld.exe \
            -D CMAKE_DLLTOOL=/${{ matrix.config.msys_variant }}/bin/dlltool.exe \
            -D CMAKE_NM=/${{ matrix.config.msys_variant }}/bin/nm.exe

        ${{ env.CMAKE_TOOL_BINARY_PATH }}\\cmake --build build --target all
        ${{ env.CMAKE_TOOL_BINARY_PATH }}\\cmake --build build --target install

        # utils and asio-utils from cosec-examples
        cd ${{ env.REPO_PATH }}/3rd-party/lebedev-utils
        mkdir prefix

        ${{ env.CMAKE_TOOL_BINARY_PATH }}\\cmake \
            -G Ninja \
            -S . \
            -B build \
            -D CMAKE_INSTALL_PREFIX="${{ env.REPO_PATH }}/3rd-party/lebedev-utils/prefix" \
            -D CMAKE_PREFIX_PATH="${{ env.REPO_PATH }}/cmake/ntc/prefix;${{ env.ROOT_PATH }}/${{ env.BOOST_INSTALL_PATH }}" \
            -D CMAKE_BUILD_TYPE=Release \
            -D CMAKE_RANLIB=/${{ matrix.config.msys_variant }}/bin/ranlib.exe \
            -D CMAKE_VERBOSE_MAKEFILE=ON \
            -D CMAKE_MAKE_PROGRAM=/${{ matrix.config.msys_variant }}/bin/ninja.exe \
            -D CMAKE_C_COMPILER=/${{ matrix.config.msys_variant }}/bin/gcc.exe \
            -D CMAKE_CXX_COMPILER=/${{ matrix.config.msys_variant }}/bin/g++.exe \
            -D CMAKE_AR=/${{ matrix.config.msys_variant }}/bin/ar.exe \
            -D CMAKE_LINKER=/${{ matrix.config.msys_variant }}/bin/ld.exe \
            -D CMAKE_DLLTOOL=/${{ matrix.config.msys_variant }}/bin/dlltool.exe \
            -D CMAKE_NM=/${{ matrix.config.msys_variant }}/bin/nm.exe

        ${{ env.CMAKE_TOOL_BINARY_PATH }}\\cmake --build build --target all
        ${{ env.CMAKE_TOOL_BINARY_PATH }}\\cmake --build build --target install
        cd ${{ env.REPO_PATH }}

    # MSYS packages (without prefix):
    # - cyrus-sasl (and gdbm as a dependency)
    # - yaml-cpp
    # - qt5 and its dependencies
    - name: MSYS cache
      uses: actions/cache@v2
      if: ${{ runner.os == 'Windows' }}
      id: cache_${{ matrix.config.msys_variant }}_windows
      with:
        path: |
          C:/msys64/${{ matrix.config.msys_variant }}/bin/gdbm_dump.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/gdbm_load.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/gdbmtool.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libgdbm-6.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libgdbm_compat-4.dll
          C:/msys64/${{ matrix.config.msys_variant }}/include/dbm.h
          C:/msys64/${{ matrix.config.msys_variant }}/include/gdbm.h
          C:/msys64/${{ matrix.config.msys_variant }}/include/ndbm.h
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libgdbm.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libgdbm.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libgdbm_compat.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libgdbm_compat.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/share/licenses/gdbm/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/libsasl2-3.dll
          C:/msys64/${{ matrix.config.msys_variant }}/include/sasl/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libsasl2.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/libsasl2.pc
          C:/msys64/${{ matrix.config.msys_variant }}/lib/sasl2/
          C:/msys64/${{ matrix.config.msys_variant }}/sbin/pluginviewer.exe
          C:/msys64/${{ matrix.config.msys_variant }}/sbin/sasldblistusers2.exe
          C:/msys64/${{ matrix.config.msys_variant }}/sbin/saslpasswd2.exe
          C:/msys64/${{ matrix.config.msys_variant }}/share/licenses/cyrus-sasl/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/yaml-cpp.dll
          C:/msys64/${{ matrix.config.msys_variant }}/include/yaml-cpp/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/cmake/yaml-cpp/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libyaml-cpp.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/yaml-cpp.pc
          C:/msys64/${{ matrix.config.msys_variant }}/lib/yaml-cpp.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/share/licenses/yaml-cpp/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/libmariadb.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/mariadb_config.exe
          C:/msys64/${{ matrix.config.msys_variant }}/include/mariadb/
          C:/msys64/${{ matrix.config.msys_variant }}/include/mysql/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libmariadb.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libmariadbclient.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libmysqlclient.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libmysqlclient.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libmysqlclient_r.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libmysqlclient_r.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/libmariadb.pc

          C:/msys64/${{ matrix.config.msys_variant }}/bin/assimp.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/assimp_viewer.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libassimp.dll
          C:/msys64/${{ matrix.config.msys_variant }}/include/assimp/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/cmake/assimp-5.0/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/cmake/assimp-5.0/assimp-config-version.cmake
          C:/msys64/${{ matrix.config.msys_variant }}/lib/cmake/assimp-5.0/assimp-config.cmake
          C:/msys64/${{ matrix.config.msys_variant }}/lib/cmake/assimp-5.0/assimpTargets-release.cmake
          C:/msys64/${{ matrix.config.msys_variant }}/lib/cmake/assimp-5.0/assimpTargets.cmake
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libassimp.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libIrrXML.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/assimp.pc
          C:/msys64/${{ matrix.config.msys_variant }}/share/licenses/assimp/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/dbus*.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libdbus-1-3.dll
          C:/msys64/${{ matrix.config.msys_variant }}/etc/dbus-1/
          C:/msys64/${{ matrix.config.msys_variant }}/include/dbus-1.0/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/cmake/DBus1/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/dbus-1.0/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libdbus-1.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libdbus-1.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/dbus-1.pc
          C:/msys64/${{ matrix.config.msys_variant }}/share/dbus-1/
          C:/msys64/${{ matrix.config.msys_variant }}/share/xml/dbus-1/
          C:/msys64/${{ matrix.config.msys_variant }}/var/lib/dbus/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/libdouble-conversion.dll
          C:/msys64/${{ matrix.config.msys_variant }}/include/double-conversion/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/cmake/double-conversion/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libdouble-conversion.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libdouble-conversion.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/share/licenses/double-conversion/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/fc-*.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libfontconfig-1.dll
          C:/msys64/${{ matrix.config.msys_variant }}/etc/fonts/conf.d/
          C:/msys64/${{ matrix.config.msys_variant }}/etc/fonts/fonts.conf
          C:/msys64/${{ matrix.config.msys_variant }}/include/fontconfig/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libfontconfig.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libfontconfig.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/fontconfig.pc
          C:/msys64/${{ matrix.config.msys_variant }}/share/fontconfig/
          C:/msys64/${{ matrix.config.msys_variant }}/share/gettext/its/fontconfig.its
          C:/msys64/${{ matrix.config.msys_variant }}/share/gettext/its/fontconfig.loc
          C:/msys64/${{ matrix.config.msys_variant }}/share/licenses/fontconfig/
          C:/msys64/${{ matrix.config.msys_variant }}/share/locale/zh_CN/LC_MESSAGES/fontconfig-conf.mo
          C:/msys64/${{ matrix.config.msys_variant }}/share/locale/zh_CN/LC_MESSAGES/fontconfig.mo
          C:/msys64/${{ matrix.config.msys_variant }}/share/xml/fontconfig/
          C:/msys64/${{ matrix.config.msys_variant }}/var/cache/fontconfig/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/libfreeglut.dll
          C:/msys64/${{ matrix.config.msys_variant }}/include/GL/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/cmake/FreeGLUT/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libfreeglut.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libfreeglut_static.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/freeglut.pc

          C:/msys64/${{ matrix.config.msys_variant }}/bin/freetype-config
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libfreetype-6.dll
          C:/msys64/${{ matrix.config.msys_variant }}/include/freetype2/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libfreetype.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libfreetype.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/freetype2.pc
          C:/msys64/${{ matrix.config.msys_variant }}/share/aclocal/freetype2.m4
          C:/msys64/${{ matrix.config.msys_variant }}/share/licenses/freetype/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/gif*.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libgif-7.dll
          C:/msys64/${{ matrix.config.msys_variant }}/include/gif_lib.h
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libgif.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libgif.dll.a

          C:/msys64/${{ matrix.config.msys_variant }}/bin/gdbus-codegen-script.py
          C:/msys64/${{ matrix.config.msys_variant }}/bin/gdbus-codegen.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/gdbus.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/gio-querymodules.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/gio.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/glib-*.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/gobject-query.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/gresource.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/gsettings.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/gspawn-win64-helper-console.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/gspawn-win64-helper.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/gtester-report-script.py
          C:/msys64/${{ matrix.config.msys_variant }}/bin/gtester-report.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libgio-2.0-0.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libglib-2.0-0.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libgmodule-2.0-0.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libgobject-2.0-0.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libgthread-2.0-0.dll
          C:/msys64/${{ matrix.config.msys_variant }}/include/gio-win32-2.0/
          C:/msys64/${{ matrix.config.msys_variant }}/include/glib-2.0/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/glib-2.0/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libgio-2.0.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libgio-2.0.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libglib-2.0.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libglib-2.0.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libgmodule-2.0.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libgmodule-2.0.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libgobject-2.0.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libgobject-2.0.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libgthread-2.0.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libgthread-2.0.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/gio-2.0.pc
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/gio-windows-2.0.pc
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/glib-2.0.pc
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/gmodule-2.0.pc
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/gmodule-export-2.0.pc
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/gmodule-no-export-2.0.pc
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/gobject-2.0.pc
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/gthread-2.0.pc
          C:/msys64/${{ matrix.config.msys_variant }}/share/aclocal/glib-2.0.m4
          C:/msys64/${{ matrix.config.msys_variant }}/share/aclocal/glib-gettext.m4
          C:/msys64/${{ matrix.config.msys_variant }}/share/aclocal/gsettings.m4
          C:/msys64/${{ matrix.config.msys_variant }}/share/gettext/its/gschema.its
          C:/msys64/${{ matrix.config.msys_variant }}/share/gettext/its/gschema.loc
          C:/msys64/${{ matrix.config.msys_variant }}/share/glib-2.0/
          C:/msys64/${{ matrix.config.msys_variant }}/share/licenses/glib2/
          C:/msys2/usr/share/libalpm/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/gr2fonttest.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libgraphite2.dll
          C:/msys64/${{ matrix.config.msys_variant }}/include/graphite2/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libgraphite2.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libgraphite2.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/graphite2.pc
          C:/msys64/${{ matrix.config.msys_variant }}/share/graphite2/
          C:/msys64/${{ matrix.config.msys_variant }}/share/licenses/graphite2/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/hb-*.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/hb-*.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/hb-*.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/hb-*.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libharfbuzz*.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libharfbuzz*.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libharfbuzz*.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libharfbuzz*.dll
          C:/msys64/${{ matrix.config.msys_variant }}/include/harfbuzz/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/cmake/harfbuzz/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/girepository-1.0/HarfBuzz-0.0.typelib
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libharfbuzz*.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libharfbuzz*.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/harfbuzz*.pc
          C:/msys64/${{ matrix.config.msys_variant }}/share/gir-1.0/HarfBuzz-0.0.gir
          C:/msys64/${{ matrix.config.msys_variant }}/share/licenses/harfbuzz/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/derb.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/genbrk.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/gencfu.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/gencnval.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/gendict.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/genrb.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/icu-config
          C:/msys64/${{ matrix.config.msys_variant }}/bin/icuinfo.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libicudt68.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libicuin68.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libicuio68.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libicutest68.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libicutu68.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libicuuc68.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/makeconv.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/pkgdata.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/uconv.exe
          C:/msys64/${{ matrix.config.msys_variant }}/include/unicode/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/icu/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libicu*.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libicu*.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/icu-i18n.pc
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/icu-io.pc
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/icu-uc.pc
          C:/msys64/${{ matrix.config.msys_variant }}/sbin/escapesrc.exe
          C:/msys64/${{ matrix.config.msys_variant }}/sbin/genccode.exe
          C:/msys64/${{ matrix.config.msys_variant }}/sbin/gencmn.exe
          C:/msys64/${{ matrix.config.msys_variant }}/sbin/gennorm2.exe
          C:/msys64/${{ matrix.config.msys_variant }}/sbin/gensprep.exe
          C:/msys64/${{ matrix.config.msys_variant }}/sbin/icupkg.exe
          C:/msys64/${{ matrix.config.msys_variant }}/share/icu/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/imgcmp.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/imginfo.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/jasper.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libjasper-4.dll
          C:/msys64/${{ matrix.config.msys_variant }}/include/jasper/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libjasper.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libjasper.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/jasper.pc
          C:/msys64/${{ matrix.config.msys_variant }}/share/licenses/jasper/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/jpgicc.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/liblcms2-2.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/linkicc.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/psicc.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/tificc.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/transicc.exe
          C:/msys64/${{ matrix.config.msys_variant }}/include/lcms2.h
          C:/msys64/${{ matrix.config.msys_variant }}/include/lcms2_plugin.h
          C:/msys64/${{ matrix.config.msys_variant }}/lib/liblcms2.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/liblcms2.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/lcms2.pc

          C:/msys64/${{ matrix.config.msys_variant }}/bin/dumpsexp.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/hmac256.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libgcrypt-20.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libgcrypt-config
          C:/msys64/${{ matrix.config.msys_variant }}/bin/mpicalc.exe
          C:/msys64/${{ matrix.config.msys_variant }}/include/gcrypt.h
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libgcrypt.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libgcrypt.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/libgcrypt.pc
          C:/msys64/${{ matrix.config.msys_variant }}/share/aclocal/libgcrypt.m4
          C:/msys64/${{ matrix.config.msys_variant }}/share/licenses/libgcrypt/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/gpg-error-config
          C:/msys64/${{ matrix.config.msys_variant }}/bin/gpg-error.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/gpgrt-config
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libgpg-error-0.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/yat2m.exe
          C:/msys64/${{ matrix.config.msys_variant }}/include/gpg-error.h
          C:/msys64/${{ matrix.config.msys_variant }}/include/gpgrt.h
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libgpg-error.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libgpg-error.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/gpg-error.pc
          C:/msys64/${{ matrix.config.msys_variant }}/share/aclocal/gpg-error.m4
          C:/msys64/${{ matrix.config.msys_variant }}/share/aclocal/gpgrt.m4
          C:/msys64/${{ matrix.config.msys_variant }}/share/common-lisp/
          C:/msys64/${{ matrix.config.msys_variant }}/share/libgpg-error/
          C:/msys64/${{ matrix.config.msys_variant }}/share/licenses/libgpg-error/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/cjpeg.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/djpeg.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/jpegtran.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libjpeg-8.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libturbojpeg.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/rdjpgcom.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/tjbench.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/wrjpgcom.exe
          C:/msys64/${{ matrix.config.msys_variant }}/include/jconfig.h
          C:/msys64/${{ matrix.config.msys_variant }}/include/jerror.h
          C:/msys64/${{ matrix.config.msys_variant }}/include/jinclude.h
          C:/msys64/${{ matrix.config.msys_variant }}/include/jmorecfg.h
          C:/msys64/${{ matrix.config.msys_variant }}/include/jpeglib.h
          C:/msys64/${{ matrix.config.msys_variant }}/include/transupp.h
          C:/msys64/${{ matrix.config.msys_variant }}/include/turbojpeg.h
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libjpeg.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libjpeg.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libturbojpeg.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libturbojpeg.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/libjpeg.pc
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/libturbojpeg.pc
          C:/msys64/${{ matrix.config.msys_variant }}/share/licenses/libjpeg-turbo/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/libmng-2.dll
          C:/msys64/${{ matrix.config.msys_variant }}/include/libmng.h
          C:/msys64/${{ matrix.config.msys_variant }}/include/libmng_conf.h
          C:/msys64/${{ matrix.config.msys_variant }}/include/libmng_types.h
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libmng.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libmng.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/libmng.pc
          C:/msys64/${{ matrix.config.msys_variant }}/share/mng-2.0/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/libpng-config
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libpng16-16.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libpng16-config
          C:/msys64/${{ matrix.config.msys_variant }}/bin/png-fix-itxt.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/png2pnm-static.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/png2pnm.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/pngfix.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/pnm2png-static.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/pnm2png.exe
          C:/msys64/${{ matrix.config.msys_variant }}/include/libpng16/
          C:/msys64/${{ matrix.config.msys_variant }}/include/png.h
          C:/msys64/${{ matrix.config.msys_variant }}/include/pngconf.h
          C:/msys64/${{ matrix.config.msys_variant }}/include/pnglibconf.h
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libpng.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libpng.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libpng16.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libpng16.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/libpng.pc
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/libpng16.pc
          C:/msys64/${{ matrix.config.msys_variant }}/share/licenses/libpng/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/fax2ps.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/fax2tiff.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libtiff-5.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libtiffxx-5.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/pal2rgb.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/ppm2tiff.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/raw2tiff.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/tiff*.exe
          C:/msys64/${{ matrix.config.msys_variant }}/include/tif*.h
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libtiff.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libtiff.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libtiffxx.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libtiffxx.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/libtiff-4.pc
          C:/msys64/${{ matrix.config.msys_variant }}/share/licenses/libtiff/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/cwebp.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/dwebp.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/gif2webp.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/img2webp.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libwebp-7.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libwebpdecoder-3.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libwebpdemux-2.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libwebpmux-3.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/webpinfo.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/webpmux.exe
          C:/msys64/${{ matrix.config.msys_variant }}/include/webp/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libwebp*.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libwebp*.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/libwebp*.pc

          C:/msys64/${{ matrix.config.msys_variant }}/bin/libxml2-2.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/xml2-config
          C:/msys64/${{ matrix.config.msys_variant }}/bin/xmlcatalog.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/xmllint.exe
          C:/msys64/${{ matrix.config.msys_variant }}/include/libxml2/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/cmake/libxml2/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libxml2.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libxml2.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/libxml-2.0.pc
          C:/msys64/${{ matrix.config.msys_variant }}/lib/python3.8/site-packages/drv_libxml2.py
          C:/msys64/${{ matrix.config.msys_variant }}/lib/python3.8/site-packages/libxml2.py
          C:/msys64/${{ matrix.config.msys_variant }}/lib/python3.8/site-packages/libxml2mod.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/python3.8/site-packages/libxml2mod.pyd
          C:/msys64/${{ matrix.config.msys_variant }}/lib/xml2Conf.sh
          C:/msys64/${{ matrix.config.msys_variant }}/share/aclocal/libxml.m4
          C:/msys64/${{ matrix.config.msys_variant }}/share/licenses/libxml2/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/libexslt-0.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libxslt-1.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/xslt-config
          C:/msys64/${{ matrix.config.msys_variant }}/bin/xsltproc.exe
          C:/msys64/${{ matrix.config.msys_variant }}/include/libexslt/
          C:/msys64/${{ matrix.config.msys_variant }}/include/libxslt/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libexslt.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libexslt.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libxslt-plugins/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libxslt.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libxslt.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/libexslt.pc
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/libxslt.pc
          C:/msys64/${{ matrix.config.msys_variant }}/lib/xsltConf.sh
          C:/msys64/${{ matrix.config.msys_variant }}/share/aclocal/libxslt.m4

          C:/msys64/${{ matrix.config.msys_variant }}/bin/libminizip-1.dll
          C:/msys64/${{ matrix.config.msys_variant }}/include/minizip/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/cmake/minizip-exports-release.cmake
          C:/msys64/${{ matrix.config.msys_variant }}/lib/cmake/minizip-exports.cmake
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libminizip.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libminizip.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/minizip.pc

          C:/msys64/${{ matrix.config.msys_variant }}/bin/altonegen.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libopenal-1.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/makemhr.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/openal-info.exe
          C:/msys64/${{ matrix.config.msys_variant }}/include/AL/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/cmake/OpenAL/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libopenal.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libopenal.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/openal.pc
          C:/msys64/${{ matrix.config.msys_variant }}/share/openal/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/libpcre*.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/pcre-config
          C:/msys64/${{ matrix.config.msys_variant }}/bin/pcregrep.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/pcretest.exe
          C:/msys64/${{ matrix.config.msys_variant }}/include/pcre*.h
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libpcre*.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libpcre*.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/libpcre*.pc
          C:/msys64/${{ matrix.config.msys_variant }}/share/licenses/pcre/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/libpcre2*.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/pcre2-config
          C:/msys64/${{ matrix.config.msys_variant }}/bin/pcre2grep.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/pcre2test.exe
          C:/msys64/${{ matrix.config.msys_variant }}/include/pcre2.h
          C:/msys64/${{ matrix.config.msys_variant }}/include/pcre2posix.h
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libpcre2*.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libpcre2*.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/libpcre2*.pc

          C:/msys64/${{ matrix.config.msys_variant }}/include/vulkan/
          C:/msys64/${{ matrix.config.msys_variant }}/share/licenses/vulkan-headers/
          C:/msys64/${{ matrix.config.msys_variant }}/share/vulkan/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/libvulkan-1.dll
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libvulkan.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/vulkan.pc
          C:/msys64/${{ matrix.config.msys_variant }}/share/licenses/vulkan-loader/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/edit.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/edit_test.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/edit_test_dll.exe
          C:/msys64/${{ matrix.config.msys_variant }}/include/editline/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libedit.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libedit_static.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/wineditline.pc
          C:/msys64/${{ matrix.config.msys_variant }}/share/licenses/wineditline/

          C:/msys64/${{ matrix.config.msys_variant }}/bin/cxpm-noX.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/libXpm-noX4.dll
          C:/msys64/${{ matrix.config.msys_variant }}/include/X11/simx.h
          C:/msys64/${{ matrix.config.msys_variant }}/include/X11/xpm.h
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libXpm.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libXpm.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/xpm.pc

          C:/msys64/${{ matrix.config.msys_variant }}/bin/libzzip*.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/unzip-mem.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/unzzip*.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/zz*.exe
          C:/msys64/${{ matrix.config.msys_variant }}/include/SDL_rwops_zzip/
          C:/msys64/${{ matrix.config.msys_variant }}/include/zzip-io.h
          C:/msys64/${{ matrix.config.msys_variant }}/include/zzip.h
          C:/msys64/${{ matrix.config.msys_variant }}/include/zzip/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libzzip*.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libzzip*.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/SDL_rwops_zzip.pc
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/zzip*.pc
          C:/msys64/${{ matrix.config.msys_variant }}/share/aclocal/zziplib.m4

          C:/msys64/${{ matrix.config.msys_variant }}/bin/balsam.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/canbusutil.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/dumpcpp.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/dumpdoc.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/fixqt4headers.pl
          C:/msys64/${{ matrix.config.msys_variant }}/bin/idc.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/lconvert.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/linguist.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/lprodump.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/lrelease-pro.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/lrelease.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/lupdate-pro.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/lupdate.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/meshdebug.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/moc.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/pixeltool.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/qcollectiongenerator.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/qdbus.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/qdbuscpp2xml.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/qdbusviewer.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/qdbusxml2cpp.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/qdistancefieldgenerator.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/qdoc.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/qgltf.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/qhelpgenerator.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/qlalr.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/qmake.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/qscxmlc.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/Qt5Core.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/Qt5Gui.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/Qt5Sql.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/Qt5Widgets.dll
          C:/msys64/${{ matrix.config.msys_variant }}/bin/qtattributionsscanner.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/qtdiag.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/qtpaths.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/qtplugininfo.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/qvkgen.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/rcc.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/repc.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/syncqt.pl
          C:/msys64/${{ matrix.config.msys_variant }}/bin/testcon.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/tracegen.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/uic.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/windeployqt.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/xmlpatterns.exe
          C:/msys64/${{ matrix.config.msys_variant }}/bin/xmlpatternsvalidator.exe
          C:/msys64/${{ matrix.config.msys_variant }}/include/ActiveQt/
          C:/msys64/${{ matrix.config.msys_variant }}/include/QtCore/
          C:/msys64/${{ matrix.config.msys_variant }}/include/QtGui/
          C:/msys64/${{ matrix.config.msys_variant }}/include/QtSql/
          C:/msys64/${{ matrix.config.msys_variant }}/include/QtWidgets/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/cmake/Qt5*/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libQt5Core.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libQt5Gui.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libQt5Sql.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libQt5Widgets.dll.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libqtmain.a
          C:/msys64/${{ matrix.config.msys_variant }}/lib/metatypes/qt5core_metatypes.json
          C:/msys64/${{ matrix.config.msys_variant }}/lib/metatypes/qt5gui_metatypes.json
          C:/msys64/${{ matrix.config.msys_variant }}/lib/metatypes/qt5widgets_metatypes.json
          C:/msys64/${{ matrix.config.msys_variant }}/lib/pkgconfig/Qt5*.pc
          C:/msys64/${{ matrix.config.msys_variant }}/lib/Qt5*.prl
          C:/msys64/${{ matrix.config.msys_variant }}/lib/qtmain.prl
          C:/msys64/${{ matrix.config.msys_variant }}/share/licenses/qt5/
          C:/msys64/${{ matrix.config.msys_variant }}/share/qt5/mkspecs/
          C:/msys64/${{ matrix.config.msys_variant }}/share/qt5/phrasebooks/
          C:/msys64/${{ matrix.config.msys_variant }}/share/qt5/plugins/
          C:/msys64/${{ matrix.config.msys_variant }}/share/qt5/translations/

          C:/msys64/${{ matrix.config.msys_variant }}/include/catch2/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/cmake/Catch2/
          C:/msys64/${{ matrix.config.msys_variant }}/lib/libCatch2WithMain.a
          C:/msys64/${{ matrix.config.msys_variant }}/share/Catch2/
          C:/msys64/${{ matrix.config.msys_variant }}/share/licenses/
          C:/msys64/${{ matrix.config.msys_variant }}/share/pkgconfig/
        key: ${{ runner.os }}-${{ matrix.config.msys_variant }}-${{ env.MSYS_CACHE_VERSION }}

    - name: Cyrus SASL
      if: ${{ runner.os == 'Windows' && steps.cache_${{ matrix.config.msys_variant }}_windows.outputs.cache-hit != 'true' }}
      shell: C:\\msys64\\msys2_shell.cmd -defterm -no-start -${{ matrix.config.msys_variant }} -shell sh {0}
      run: |
        pacman -S --noconfirm ${{ matrix.config.package_prefix }}cyrus-sasl

    - name: Yaml CPP
      if: ${{ runner.os == 'Windows' && steps.cache_${{ matrix.config.msys_variant }}_windows.outputs.cache-hit != 'true' }}
      shell: C:\\msys64\\msys2_shell.cmd -defterm -no-start -${{ matrix.config.msys_variant }} -shell sh {0}
      run: |
        pacman -S --noconfirm ${{ matrix.config.package_prefix }}yaml-cpp

    - name: MariaDB
      if: ${{ runner.os == 'Windows' && steps.cache_${{ matrix.config.msys_variant }}_windows.outputs.cache-hit != 'true' }}
      shell: C:\\msys64\\msys2_shell.cmd -defterm -no-start -${{ matrix.config.msys_variant }} -shell sh {0}
      run: |
        pacman -S --noconfirm ${{ matrix.config.package_prefix }}libmariadbclient

    - name: Qt5
      if: ${{ runner.os == 'Windows' && steps.cache_${{ matrix.config.msys_variant }}_windows.outputs.cache-hit != 'true' }}
      shell: C:\\msys64\\msys2_shell.cmd -defterm -no-start -${{ matrix.config.msys_variant }} -shell sh {0}
      run: |
        pacman -S --noconfirm ${{ matrix.config.package_prefix }}qt5

    - name: Catch2
      if: ${{ runner.os == 'Windows' && steps.cache_${{ matrix.config.msys_variant }}_windows.outputs.cache-hit != 'true' }}
      shell: C:\\msys64\\msys2_shell.cmd -defterm -no-start -${{ matrix.config.msys_variant }} -shell sh {0}
      run: |
        pacman -S --noconfirm ${{ matrix.config.package_prefix }}catch

    - name: SQLPP11 cache
      uses: actions/cache@v2
      id: cache_sqlpp11
      with:
        path: ${{ env.ROOT_PATH }}/${{ env.SQLPP11_INSTALL_PATH }}
        key: ${{ runner.os }}-sqlpp11-${{ env.SQLPP11_VERSION }}-connector-mysql-${{ env.SQLPP11_CONNECTOR_MYSQL_VERSION }}-4

    - name: SQLPP11
      if: ${{ steps.cache_sqlpp11.outputs.cache-hit != 'true' }}
      env:
        CC: ${{ matrix.config.cc }}
        CXX: ${{ matrix.config.cxx }}
      shell: python {0}
      run: |
        import os
        import requests
        import subprocess

        def execute_command(cmd):
          ret = subprocess.call(cmd, shell=True)
          if ret != 0:
            raise RuntimeError('Exit code {} while executing "{}"'.format(ret, cmd))

        def execute_msys_command(cmd):
          cmd_prefix = "C:/msys64/msys2_shell.cmd -defterm -no-start -here -${{ matrix.config.msys_variant }} -shell sh -c "
          execute_command(cmd_prefix + '"{}"'.format(cmd))

        root = os.environ['ROOT_PATH']
        repo = os.environ['REPO_PATH']
        ninja_tool_path = os.environ['NINJA_TOOL_PATH']
        ninja_binary = os.path.join(root, ninja_tool_path, "ninja").replace("\\", "/")
        cmake_tool_binary_path = os.environ['CMAKE_TOOL_BINARY_PATH']
        cmake_binary = os.path.join(cmake_tool_binary_path, "cmake").replace("\\", "/")

        # sqlpp11 itself
        os.chdir(root)

        sqlpp11_version = os.environ['SQLPP11_VERSION']
        sqlpp11_source_dir  = os.path.normpath(os.path.join(root, "sqlpp11-{}".format(sqlpp11_version)))
        sqlpp11_install_dir = os.path.normpath(os.path.join(root, "${{ env.SQLPP11_INSTALL_PATH }}")).replace("\\", "/")
        os.mkdir(sqlpp11_install_dir)

        sqlpp11_url = "https://github.com/rbock/sqlpp11/archive/{}.zip".format(sqlpp11_version)
        open("sqlpp11.zip", "wb").write(requests.get(sqlpp11_url, allow_redirects=True).content)
        execute_command("7z x sqlpp11.zip")

        os.chdir(sqlpp11_source_dir)

        execute_msys_command(("{} -GNinja -DCMAKE_MAKE_PROGRAM={} -DCMAKE_BUILD_TYPE=Release " +
                              "-DBUILD_TESTING=OFF -DCMAKE_INSTALL_PREFIX={} -DCMAKE_PREFIX_PATH={} " +
                              ".").format(cmake_binary, ninja_binary, sqlpp11_install_dir,
                                          root + "/" + os.environ['BOOST_INSTALL_PATH']))
        execute_msys_command("{} --build . --target all".format(cmake_binary))
        execute_msys_command("{} --build . --target install".format(cmake_binary))

        # chrono date (sqlpp11 connector mysql dependency)
        os.chdir(root)

        chrono_date_version = os.environ['CHRONO_DATE_VERSION']
        chrono_date_source_dir  = os.path.normpath(os.path.join(root, "date-{}".format(chrono_date_version)))

        chrono_date_url = "https://github.com/HowardHinnant/date/archive/v{}.zip".format(chrono_date_version)
        open("chrono_date.zip", "wb").write(requests.get(chrono_date_url, allow_redirects=True).content)
        execute_command("7z x chrono_date.zip")

        os.chdir(chrono_date_source_dir)

        execute_msys_command(("{} -GNinja -DCMAKE_MAKE_PROGRAM={} " +
                              "-DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX={} " +
                              ".").format(cmake_binary, ninja_binary, sqlpp11_install_dir))
        execute_msys_command("{} --build . --target all".format(cmake_binary))
        execute_msys_command("{} --build . --target install".format(cmake_binary))

        # sqlpp11 connector mysql
        os.chdir(root)

        sqlpp11_conn_version = os.environ['SQLPP11_CONNECTOR_MYSQL_VERSION']
        sqlpp11_conn_source_dir  = os.path.normpath(os.path.join(root, "sqlpp11-connector-mysql-{}".format(sqlpp11_conn_version)))

        sqlpp11_conn_url = "https://github.com/rbock/sqlpp11-connector-mysql/archive/{}.zip".format(sqlpp11_conn_version)
        open("sqlpp11_conn.zip", "wb").write(requests.get(sqlpp11_conn_url, allow_redirects=True).content)
        execute_command("7z x sqlpp11_conn.zip")

        os.chdir(sqlpp11_conn_source_dir)

        execute_msys_command(("{} -GNinja -DCMAKE_MAKE_PROGRAM={} " +
                              "-DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX={} -DUSE_MARIADB=TRUE " +
                              "-DDATE_INCLUDE_DIR={}/include -DSQLPP11_INCLUDE_DIR={}/include -DENABLE_TESTS=OFF " +
                              ".").format(cmake_binary, ninja_binary, sqlpp11_install_dir,
                                          sqlpp11_install_dir, sqlpp11_install_dir))
        execute_msys_command("{} --build . --target all".format(cmake_binary))
        execute_msys_command("{} --build . --target install".format(cmake_binary))

        os.chdir(repo)

    - name: Catch2 cache
      uses: actions/cache@v2
      id: cache_catch2
      with:
        path: ${{ env.ROOT_PATH }}/${{ env.CATCH2_INSTALL_PATH }}
        key: ${{ runner.os }}-catch2-${{ env.CATCH2_VERSION }}

    - name: Catch2
      if: ${{ steps.cache_catch2.outputs.cache-hit != 'true' }}
      env:
        CC: ${{ matrix.config.cc }}
        CXX: ${{ matrix.config.cxx }}
      shell: python3 {0}
      run: |
        import os
        import requests
        import subprocess

        def execute_command(cmd):
          ret = subprocess.call(cmd, shell=True)
          if ret != 0:
            raise RuntimeError('Exit code {} while executing "{}"'.format(ret, cmd))

        def execute_msys_command(cmd):
          cmd_prefix = "C:/msys64/msys2_shell.cmd -defterm -no-start -here -${{ matrix.config.msys_variant }} -shell sh -c "
          execute_command(cmd_prefix + '"{}"'.format(cmd))

        root = os.environ['ROOT_PATH']
        repo = os.environ['REPO_PATH']
        ninja_tool_path = os.environ['NINJA_TOOL_PATH']
        ninja_binary = os.path.join(root, ninja_tool_path, "ninja").replace("\\", "/")
        cmake_tool_binary_path = os.environ['CMAKE_TOOL_BINARY_PATH']
        cmake_binary = os.path.join(cmake_tool_binary_path, "cmake").replace("\\", "/")

        os.chdir(root)

        catch2_version = os.environ['CATCH2_VERSION']

        catch2_source_dir  = os.path.normpath(os.path.join(root, "Catch2-{}".format(catch2_version)))
        catch2_install_dir = os.path.normpath(os.path.join(root, "${{ env.CATCH2_INSTALL_PATH }}")).replace("\\", "/")
        os.mkdir(catch2_install_dir)

        catch2_url = "https://github.com/catchorg/Catch2/archive/v{}.tar.gz".format(catch2_version)
        open("catch2.tar.gz", "wb").write(requests.get(catch2_url, allow_redirects=True).content)
        execute_msys_command("tar -xf catch2.tar.gz")

        os.chdir(catch2_source_dir)

        execute_msys_command("{} -B build -DBUILD_TESTING=OFF -GNinja -DCMAKE_MAKE_PROGRAM={} -DCMAKE_INSTALL_PREFIX={}  "
                             ".".format(cmake_binary, ninja_binary,
                                        catch2_install_dir))
        execute_msys_command("{} --build build --target all".format(cmake_binary))
        execute_msys_command("{} --build build --target install".format(cmake_binary))
        os.chdir(repo)

    - name: Configure
      if: ${{ runner.os == 'Windows' }}
      env:
        CC: ${{ matrix.config.cc }}
        CXX: ${{ matrix.config.cxx }}
      shell: C:\\msys64\\msys2_shell.cmd -defterm -no-start -here -${{ matrix.config.msys_variant }} -shell sh {0}
      run: |
        ${{ env.CMAKE_TOOL_BINARY_PATH }}\\cmake \
        -G Ninja \
        -S . \
        -B build \
        -D CMAKE_BUILD_TYPE=${{ matrix.config.build_type }} \
        -D CMAKE_RANLIB=/${{ matrix.config.msys_variant }}/bin/ranlib.exe \
        -D CMAKE_VERBOSE_MAKEFILE=ON \
        -D CMAKE_MAKE_PROGRAM=/${{ matrix.config.msys_variant }}/bin/ninja.exe \
        -D CMAKE_C_COMPILER=/${{ matrix.config.msys_variant }}/bin/gcc.exe \
        -D CMAKE_CXX_COMPILER=/${{ matrix.config.msys_variant }}/bin/g++.exe \
        -D CMAKE_AR=/${{ matrix.config.msys_variant }}/bin/ar.exe \
        -D CMAKE_LINKER=/${{ matrix.config.msys_variant }}/bin/ld.exe \
        -D CMAKE_DLLTOOL=/${{ matrix.config.msys_variant }}/bin/dlltool.exe \
        -D CMAKE_NM=/${{ matrix.config.msys_variant }}/bin/nm.exe \
        -D CMAKE_PREFIX_PATH=\
        "/${{ matrix.config.msys_variant }};\
        ${{ env.ROOT_PATH }}/${{ env.BOOST_INSTALL_PATH }};\
        ${{ env.ROOT_PATH }}/${{ env.SQLPP11_INSTALL_PATH }};\
        ${{ env.ROOT_PATH }}/${{ env.CATCH2_INSTALL_PATH }};\
        ${{ env.REPO_PATH }}/3rd-party/lebedev-utils/prefix"

    - name: Build
      run: ${{ env.CMAKE_TOOL_BINARY_PATH }}\\cmake --build build --target all

    - name: Run tests
      shell: C:\\msys64\\msys2_shell.cmd -defterm -no-start -${{ matrix.config.msys_variant }} -shell sh {0}
      run: |
        #cd build
        #ctest
        #cd ..

    - name: Install Strip
      run: ${{ env.CMAKE_TOOL_BINARY_PATH }}\\cmake --install build --prefix install --strip

    - name: Copy required DLL
      if: ${{ runner.os == 'Windows' }}
      run: |
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\libstdc++-6.dll"            install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\libgcc_s_seh-1.dll"         install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\libwinpthread-1.dll"        install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\libmariadb.dll"             install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\Qt5Core.dll"                install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\Qt5Gui.dll"                 install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\Qt5Sql.dll"                 install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\Qt5Widgets.dll"             install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\libicuin68.dll"             install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\libdouble-conversion.dll"   install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\libicuuc68.dll"             install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\libzstd.dll"                install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\libpcre2-16-0.dll"          install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\libicudt68.dll"             install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\libharfbuzz-0.dll"          install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\libpng16-16.dll"            install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\libgraphite2.dll"           install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\libglib-2.0-0.dll"          install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\libfreetype-6.dll"          install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\libintl-8.dll"              install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\libpcre-1.dll"              install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\libbrotlidec.dll"           install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\libbz2-1.dll"               install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\libbrotlicommon.dll"        install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\libiconv-2.dll"             install\\bin
        copy "C:\\msys64\\${{ matrix.config.msys_variant }}\\bin\\zlib1.dll"                  install\\bin

    - name: Win Deploy Qt
      if: ${{ runner.os == 'Windows' }}
      shell: C:\\msys64\\msys2_shell.cmd -defterm -no-start -here -${{ matrix.config.msys_variant }} -shell sh {0}
      run: |
        windeployqt.exe --dir install/bin install/bin/melon-client-desktop.exe

    - name: Upload binaries
      if: ${{ runner.os == 'Windows' }}
      uses: actions/upload-artifact@v2
      with:
        path: ./install
        name: ${{ matrix.config.artifact }}-${{ matrix.config.msys_variant }}
